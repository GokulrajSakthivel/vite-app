# This "input" configures a global authorization rule to enable public access to
# all models in this schema. Learn more about authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules
input AMPLIFY { globalAuthRule: AuthRule = { allow: public } } # FOR TESTING ONLY!


type Users @model @auth(rules: [
  { allow: private, provider: userPools }
]) {
  id: ID!
  email:String!
  name: String
  addresses: [Address] @hasMany(indexName: "byUser", fields: ["id"])
}

type Address
  @model
  @auth(rules: [{ allow: private, provider: userPools }]) {
  id: ID!
  userID: ID! @index(name: "byUser")
  country: String!
  phone: String!
}



type Master
@model
@auth(rules: [{ allow: private, provider: userPools}]) {
  id: ID! @primaryKey
  masterTitle: String
  categoryName: String @index(name: "byCategoryName", queryField: "mastersByCategoryName")
  masterName: String @index(name: "byMasterName", queryField: "mastersByMasterName")
  masterDescription: String
  displayOrder: Int
  isActive: Boolean
  createdBy: String
  modifiedBy: String
  items: [MasterItem] @hasMany(fields: ["id"])
}
 
type MasterItem
@model
@auth(rules: [{ allow: private, provider: userPools}]) {
  masterID: ID!
    @primaryKey(sortKeyFields: ["id"])
 
  id: ID!
  itemName: String
  itemType: String
  itemAttributes: [String]
  mastercode: String
  displayOrder: Int  
  isActive: Boolean  
  createdBy: String
  modifiedBy: String
}



type HazardandMeasuresControlDef
{    
    hazard:String
    hazardMeasures: [String]
}
 
type PtpOptionsInfo
{
    requiredPermits : [String]
    requiredChecklist : [String]
    requiredPPE : [String]
    hazardandMeasures: [HazardandMeasuresControlDef]
}
 

type PtpTemplateDef
@model
@auth(rules: [{allow: private, provider: userPools}])
{
    id: ID! @primaryKey(sortKeyFields: ["templateName"])
    templateName: String!
    ptpOptions: PtpOptionsInfo
    isTemplateUsed: String
    isActive: Boolean
    createdBy: String
    modifiedBy: String
}




type HazardSelections
{
  hazard: String
  hazardMeasure: [String]
  rcd: Int
}
 
type PTPSelections
{
  requiredPermits: [String]
  rquiredChecklist: [String]
  requiredPPE: [String]
  hazardAndHazardMeasure: [HazardSelections]
}
 
type ForemanSignInfo
{
  foremanName: String
  signIn: String
  signInDateTime: AWSDateTime!
  signOut: String
  signOutDateTime:AWSDateTime!
  companyName: String
}
 
type EmergencyContactInfo
{
  isEmergencyActionPlanDiscussed: Boolean
  safety: String
  superintendent: String
  emergencyMusterArea: String  
  other: String
}
 
type ShiftReviewInfo
{
  isAllToolsusedAndStroedProperly: Boolean
  haveAllPermitsClosed: Boolean
  didAnyIncidentesorInjuries: Boolean
  wasTheIncidentReported: Boolean
  descriptionOfIncident: String
}
 
 
type PTPTemplate @model
@auth(rules: [{ allow: private, provider: userPools }]) {
  templateDefId: ID! @primaryKey
  id: ID!
  ptpOptonsSelection: [PTPSelections]
  foremanSignInandOut : [ForemanSignInfo]
  emergencyContacts: [EmergencyContactInfo]
  shiftReviewes: [ShiftReviewInfo]
  status: String
  createdBy: String
  modifiedBy: String
  tasks: [PTPTasksValue] @hasMany(fields:["id"])
}
 
type TaskDef
{
  task: String
  toolsAndEquipment: String
  taskHazarad: String
  hazardControl: String
  competentPerson: String
}
 
type CrewLoginInfo
{
   crewName : String
   signIn: String
   signInDateTime : AWSDateTime!
   signInComments: String
   signOut: String
   signOutDateTime : AWSDateTime!
   signOutComments: String
}
 
type PTPTasksValue
@model
@auth(rules: [{ allow: private, provider: userPools }]) {
  templateId: ID! @primaryKey
  entityType: String
  ptpTasks: [TaskDef]
  crewMemberLogin: [CrewLoginInfo]
  createdBy: String
  modifiedBy: String
}

type ProjectSiteHierarchy
@model
@auth(rules: [{ allow: private, provider: userPools }]) {
  userId: ID!  @primaryKey(sortKeyFields: ["projectSortKey"])
  projectSortKey: ID!
  entityType: String
  region: String
  businessUnit: String
  projectSite: String
}